var PersonalData,__bind=function(e,t){return function(){return e.apply(t,arguments)}};PersonalData=function(){function e(){this.afterCheck=__bind(this.afterCheck,this),this.avatarSelected=__bind(this.avatarSelected,this),this.removeAvatar=__bind(this.removeAvatar,this),this.drop=__bind(this.drop,this),this.checkDate=__bind(this.checkDate,this);var e,t,i,r;if(this.form=$("form.panel"),1!==this.form.length)throw{error:"не найдена форма"};this.file=this.form.find("#registration-avatar"),this.avatarTemplate=document.getElementById("current-avatar-template"),this.fileSelector=$(".file-selector"),FileAPI.event.on(document.getElementById("registration-avatar"),"change",this.avatarSelected),$(document).dnd(this.over,this.drop),FileAPI.event.on(document,"drop",this.droped),$("select").chosen({disable_search_threshold:30}),e=$("#experience"),e.noUiSlider({step:1,connect:"lower",start:0,range:{min:[0],max:[50]},format:wNumb({decimals:0})}),e.Link("lower").to($("#experience-value")),i=$(".sertificats"),i.length>0&&$(".sertificats").fileapi({url:"http://websaints.net/test.php",duplicate:!1,accept:"image/*",maxSize:5*FileAPI.MB,autoUpload:!1,multiple:!0,elements:{ctrl:{upload:".add-sertificat label"},list:".sertificat-list"}}),this.form.h5Validate(),this.form.on("submit",this.afterCheck),this.mounth_widget=this.form.find(".month.dropdown-widget"),this.month=this.mounth_widget.find("select"),this.year_widget=this.form.find(".year.dropdown-widget"),this.year=this.year_widget.find("select"),this.day=this.form.find("input.day"),this.day.on("change",this.checkDate),this.month.on("change",this.checkDate),this.year.on("change",this.checkDate),t=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("city"),queryTokenizer:Bloodhound.tokenizers.whitespace,prefetch:"https://dl.dropboxusercontent.com/u/20810772/citys.json"}),t.initialize(),$("#city").typeahead({hint:!0,highlight:!0,minLength:1},{name:"locations",displayKey:"city",source:t.ttAdapter(),templates:{suggestion:Handlebars.compile("<p><b>{{region}}</b>{{city}}</p>")}}),r=new Bloodhound({datumTokenizer:function(e){return Bloodhound.tokenizers.whitespace(e.title)},queryTokenizer:Bloodhound.tokenizers.whitespace,local:[{title:"Andorra"},{title:"UnitedArabEmirates"},{title:"Afghanistan"},{title:"AntiguaandBarbuda"},{title:"Anguilla"},{title:"Albania"},{title:"Armenia"},{title:"Angola"},{title:"Antarctica"}]}),r.initialize(),$("#univercity").typeahead({hint:!0,highlight:!0,minLength:1},{name:"univercitys",displayKey:"title",source:r.ttAdapter(),templates:{suggestion:Handlebars.compile("<p>{{title}}</p>")}})}return e.prototype.checkDate=function(){var e,t;return e=parseInt(this.day.val().trim(),10),1>e||isNaN(e)?void this.day.val(1):this.mounth_widget.hasClass("unchanged")||this.year_widget.hasClass("unchanged")?e>31?this.day.val(31):void 0:(t=parseInt(moment(this.year.val()+"-"+(parseInt(this.month.val(),10)+1),"YYYY-MM").daysInMonth(),10),void(e>t&&this.day.val(t)))},e.prototype.droped=function(e){return e.preventDefault(),console.log("droped",e),FileAPI.getDropFiles(e,function(e){return console.log("file: ",e)})},e.prototype.over=function(){},e.prototype.drop=function(e){var t;return console.log("drop",e.length,e),e.length?(t=new FileReader,t.onload=function(e){return function(t){var i,r;return e.avatarTemplate.content.querySelector("img").src=t.target.result,i=document.importNode(e.avatarTemplate.content,!0),r=e.fileSelector.prev(),r.hasClass("current-avatar")&&r.remove(),e.fileSelector.before(i),e.fileSelector.prev().find(".close").on("click",e.removeAvatar)}}(this),t.readAsDataURL(e[0])):void 0},e.prototype.removeAvatar=function(e){return e.preventDefault(),this.fileSelector.prev().remove(),this.file.replaceWith(this.file.val("").clone(!0)),this.file=this.form.find("#registration-avatar")},e.prototype.avatarSelected=function(e){var t,i,r;return i=FileAPI.getFiles(e),t=i[0].name.substring(i[0].name.lastIndexOf(".")+1).toLowerCase(),!i[0]||"gif"!==t&&"png"!==t&&"jpeg"!==t&&"jpg"!==t?void 0:(r=new FileReader,r.onload=function(e){return function(t){var i,r;return e.avatarTemplate.content.querySelector("img").src=t.target.result,i=document.importNode(e.avatarTemplate.content,!0),r=e.fileSelector.prev(),r.hasClass("current-avatar")&&r.remove(),e.fileSelector.before(i),e.fileSelector.prev().find(".close").on("click",e.removeAvatar)}}(this),r.readAsDataURL(i[0]))},e.prototype.afterCheck=function(e){var t,i,r,a,n;if(this.form.find("input.ui-state-error, select.ui-state-error, textarea.ui-state-error").length>0)return!1;for(t=!1,n=this.form.find(".dropdown-widget"),r=0,a=n.length;a>r;r++)i=n[r],i.controller.validate()||(t=!0);return t?(e.preventDefault(),!1):void 0},e}(),$(document).ready(function(){return new PersonalData});
//# sourceMappingURL=data:application/json;base64,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RUFBQSxDQUdBLE9BSEEsR0FBUSxRQUFRLFNBQVMsR0FFekIsRUFBTSxFQUFNLEdBQUcsS0FBUSxVQUFVLEVBQU0sR0FBRyxLQUFRLFlBQVksS0FBTyxHQUFHLGVBQ3BFLEVBQU0sSUFBYyxRQUFQLEdBQXVCLFFBQVAsR0FBdUIsU0FBUCxHQUF3QixRQUFQLEVBQWxFLFFBRUUsRUFBYSxHQUFBLFlBQ2IsRUFBTyxPQUFTLFNBQUEsU0FBQSxVQUFDLEdBRWYsR0FBQSxHQUFBLFFBQUEsR0FBQyxlQUFlLFFBQVEsY0FBYyxPQUFPLElBQU0sRUFBTSxPQUFPLE9BQ2hFLEVBQVMsU0FBUyxXQUFXLEVBQUMsZUFBZSxTQUFTLEdBQ3RELEVBQU8sRUFBQyxhQUFhLE9BQ2xCLEVBQUssU0FBUyxtQkFDZixFQUFLLFNBQ1AsRUFBQyxhQUFhLE9BQU8sR0FDckIsRUFBQyxhQUFhLE9BQU8sS0FBSyxVQUFVLEdBQUcsUUFBUyxFQUFDLGdCQVJuQyxNQVVoQixFQUFPLGNBQWMsRUFBTSxNQWxLL0IsRUFBQSxVQXFLQSxXQUFZLFNBQUMsR0FFWCxHQUFBLEdBQUEsRUFBQSxFQUFBLEVBQUEsQ0FBQSxJQUFHLEtBQUMsS0FBSyxLQUFLLHdFQUF3RSxPQUFTLEVBQzdGLE9BQU8sQ0FJVCxLQUZBLEdBQWdCLEVBRWhCLEVBQUEsS0FBQSxLQUFBLEtBQUEsb0JBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxPQUFBLEVBQUEsRUFBQSxXQUNLLEVBQU8sV0FBVyxhQUNuQixHQUFnQixFQUVwQixPQUFHLElBQ0QsRUFBTSxrQkFDQyxHQUZULGFBakxKLEVBc0xFLFVBQVUsTUFBTSxpQkFDWixJQUFBIiwiZmlsZSI6IlBlcnNvbmFsRGF0YS5qcyIsInNvdXJjZXNDb250ZW50IjpbImNsYXNzIFBlcnNvbmFsRGF0YVxuICBjb25zdHJ1Y3RvcjogLT5cbiAgICBAZm9ybSA9ICQgJ2Zvcm0ucGFuZWwnXG4gICAgaWYgQGZvcm0ubGVuZ3RoICE9IDFcbiAgICAgIHRocm93IHtlcnJvcjogJ9C90LUg0L3QsNC50LTQtdC90LAg0YTQvtGA0LzQsCd9XG5cbiAgICBAZmlsZSA9IEBmb3JtLmZpbmQgJyNyZWdpc3RyYXRpb24tYXZhdGFyJ1xuICAgIEBhdmF0YXJUZW1wbGF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkICdjdXJyZW50LWF2YXRhci10ZW1wbGF0ZSdcbiAgICBAZmlsZVNlbGVjdG9yID0gJCAnLmZpbGUtc2VsZWN0b3InXG5cbiAgICBGaWxlQVBJLmV2ZW50Lm9uIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZWdpc3RyYXRpb24tYXZhdGFyJyksICdjaGFuZ2UnLCBAYXZhdGFyU2VsZWN0ZWRcbiAgICAkKGRvY3VtZW50KS5kbmQgQG92ZXIsIEBkcm9wXG5cbiAgICBGaWxlQVBJLmV2ZW50Lm9uIGRvY3VtZW50LCAnZHJvcCcsIEBkcm9wZWRcblxuICAgICQoJ3NlbGVjdCcpLmNob3NlblxuICAgICAgZGlzYWJsZV9zZWFyY2hfdGhyZXNob2xkOiAzMFxuXG4gICAgZXhwID0gJCAnI2V4cGVyaWVuY2UnXG4gICAgZXhwLm5vVWlTbGlkZXJcbiAgICAgIHN0ZXA6IDEsXG4gICAgICBjb25uZWN0OiBcImxvd2VyXCIsXG4gICAgICBzdGFydDogMCxcbiAgICAgIHJhbmdlOlxuICAgICAgICAnbWluJzogWzBdLFxuICAgICAgICAnbWF4JzogWzUwXVxuICAgICAgZm9ybWF0OiB3TnVtYlxuICAgICAgICBkZWNpbWFsczogMFxuXG4gICAgZXhwLkxpbmsoJ2xvd2VyJykudG8oJCgnI2V4cGVyaWVuY2UtdmFsdWUnKSlcblxuICAgIHNlcnRpZmljYXRzID0gJCgnLnNlcnRpZmljYXRzJylcbiAgICBpZiBzZXJ0aWZpY2F0cy5sZW5ndGg+MFxuICAgICAgJCgnLnNlcnRpZmljYXRzJykuZmlsZWFwaVxuICAgICAgICAjIHVybDogQGZvcm0uYXR0cignYWN0aW9uJyksXG4gICAgICAgIHVybDogJ2h0dHA6Ly93ZWJzYWludHMubmV0L3Rlc3QucGhwJ1xuICAgICAgICBkdXBsaWNhdGU6IGZhbHNlLFxuICAgICAgICBhY2NlcHQ6ICdpbWFnZS8qJyxcbiAgICAgICAgbWF4U2l6ZTogNSAqIEZpbGVBUEkuTUIsXG4gICAgICAgIGF1dG9VcGxvYWQ6IGZhbHNlLFxuICAgICAgICBtdWx0aXBsZTogdHJ1ZSxcbiAgICAgICAgZWxlbWVudHM6XG4gICAgICAgICAgY3RybDogXG4gICAgICAgICAgICB1cGxvYWQ6ICcuYWRkLXNlcnRpZmljYXQgbGFiZWwnXG4gICAgICAgICAgbGlzdDogJy5zZXJ0aWZpY2F0LWxpc3QnXG5cbiAgICBAZm9ybS5oNVZhbGlkYXRlKClcbiAgICBAZm9ybS5vbiAnc3VibWl0JywgQGFmdGVyQ2hlY2tcblxuICAgIEBtb3VudGhfd2lkZ2V0ID0gQGZvcm0uZmluZCAnLm1vbnRoLmRyb3Bkb3duLXdpZGdldCdcbiAgICBAbW9udGggPSAgQG1vdW50aF93aWRnZXQuZmluZCAnc2VsZWN0J1xuICAgIEB5ZWFyX3dpZGdldCA9IEBmb3JtLmZpbmQgJy55ZWFyLmRyb3Bkb3duLXdpZGdldCdcbiAgICBAeWVhciA9ICBAeWVhcl93aWRnZXQuZmluZCAnc2VsZWN0J1xuICAgIEBkYXkgPSBAZm9ybS5maW5kICdpbnB1dC5kYXknXG4gICAgXG4gICAgQGRheS5vbiAnY2hhbmdlJywgQGNoZWNrRGF0ZVxuICAgIEBtb250aC5vbiAnY2hhbmdlJywgQGNoZWNrRGF0ZVxuICAgIEB5ZWFyLm9uICdjaGFuZ2UnLCBAY2hlY2tEYXRlXG5cbiAgICBsb2NhdGlvbnMgPSBuZXcgQmxvb2Rob3VuZFxuICAgICAgZGF0dW1Ub2tlbml6ZXI6IEJsb29kaG91bmQudG9rZW5pemVycy5vYmoud2hpdGVzcGFjZShcImNpdHlcIiksXG4gICAgICBxdWVyeVRva2VuaXplcjogQmxvb2Rob3VuZC50b2tlbml6ZXJzLndoaXRlc3BhY2UsXG4gICAgICBwcmVmZXRjaDogXCJodHRwczovL2RsLmRyb3Bib3h1c2VyY29udGVudC5jb20vdS8yMDgxMDc3Mi9jaXR5cy5qc29uXCJcbiAgICBcbiAgICBsb2NhdGlvbnMuaW5pdGlhbGl6ZSgpXG5cbiAgICAkKCcjY2l0eScpLnR5cGVhaGVhZFxuICAgICAgaGludDogdHJ1ZVxuICAgICAgaGlnaGxpZ2h0OiB0cnVlXG4gICAgICBtaW5MZW5ndGg6IDFcbiAgICAsXG4gICAgICBuYW1lOiAnbG9jYXRpb25zJ1xuICAgICAgZGlzcGxheUtleTogJ2NpdHknLFxuICAgICAgc291cmNlOiBsb2NhdGlvbnMudHRBZGFwdGVyKClcbiAgICAgIHRlbXBsYXRlczpcbiAgICAgICAgc3VnZ2VzdGlvbjogSGFuZGxlYmFycy5jb21waWxlKCc8cD48Yj57e3JlZ2lvbn19PC9iPnt7Y2l0eX19PC9wPicpXG5cbiAgICB1bml2ZXJjaXR5cyA9IG5ldyBCbG9vZGhvdW5kXG4gICAgICBkYXR1bVRva2VuaXplcjogKGRhdGEpLT5cbiAgICAgICAgcmV0dXJuIEJsb29kaG91bmQudG9rZW5pemVycy53aGl0ZXNwYWNlKGRhdGEudGl0bGUpXG4gICAgICBxdWVyeVRva2VuaXplcjogQmxvb2Rob3VuZC50b2tlbml6ZXJzLndoaXRlc3BhY2UsXG4gICAgICBsb2NhbDogW3tcInRpdGxlXCI6XCJBbmRvcnJhXCJ9LHtcInRpdGxlXCI6XCJVbml0ZWRBcmFiRW1pcmF0ZXNcIn0se1widGl0bGVcIjpcIkFmZ2hhbmlzdGFuXCJ9LHtcInRpdGxlXCI6XCJBbnRpZ3VhYW5kQmFyYnVkYVwifSx7XCJ0aXRsZVwiOlwiQW5ndWlsbGFcIn0se1widGl0bGVcIjpcIkFsYmFuaWFcIn0se1widGl0bGVcIjpcIkFybWVuaWFcIn0se1widGl0bGVcIjpcIkFuZ29sYVwifSx7XCJ0aXRsZVwiOlwiQW50YXJjdGljYVwifV1cblxuICAgIHVuaXZlcmNpdHlzLmluaXRpYWxpemUoKVxuXG4gICAgJCgnI3VuaXZlcmNpdHknKS50eXBlYWhlYWRcbiAgICAgIGhpbnQ6IHRydWVcbiAgICAgIGhpZ2hsaWdodDogdHJ1ZVxuICAgICAgbWluTGVuZ3RoOiAxXG4gICAgLFxuICAgICAgbmFtZTogJ3VuaXZlcmNpdHlzJ1xuICAgICAgZGlzcGxheUtleTogJ3RpdGxlJyxcbiAgICAgIHNvdXJjZTogdW5pdmVyY2l0eXMudHRBZGFwdGVyKClcbiAgICAgIHRlbXBsYXRlczpcbiAgICAgICAgc3VnZ2VzdGlvbjogSGFuZGxlYmFycy5jb21waWxlKCc8cD57e3RpdGxlfX08L3A+JylcblxuXG4gIGNoZWNrRGF0ZTogKGV2ZW50KT0+XG4gICAgZGF5ID0gcGFyc2VJbnQgQGRheS52YWwoKS50cmltKCksIDEwXG5cbiAgICBpZiBkYXk8MSB8fCBpc05hTihkYXkpXG4gICAgICBAZGF5LnZhbCAxXG4gICAgICByZXR1cm5cblxuICAgIGlmICFAbW91bnRoX3dpZGdldC5oYXNDbGFzcygndW5jaGFuZ2VkJykgJiYgIUB5ZWFyX3dpZGdldC5oYXNDbGFzcygndW5jaGFuZ2VkJylcblxuICAgICAgZGF5cyA9IHBhcnNlSW50IG1vbWVudChAeWVhci52YWwoKStcIi1cIisocGFyc2VJbnQoQG1vbnRoLnZhbCgpLDEwKSsxKSwgXCJZWVlZLU1NXCIpLmRheXNJbk1vbnRoKCksIDEwXG4gICAgICBpZiBkYXk+ZGF5c1xuICAgICAgICBAZGF5LnZhbCBkYXlzXG4gICAgICAgIFxuICAgICAgcmV0dXJuXG5cbiAgICBpZiBkYXk+MzFcbiAgICAgIEBkYXkudmFsIDMxXG5cbiAgZHJvcGVkOiAoZXZlbnQpLT5cbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpXG4gICAgY29uc29sZS5sb2cgJ2Ryb3BlZCcsIGV2ZW50XG4gICAgRmlsZUFQSS5nZXREcm9wRmlsZXMgZXZlbnQsIChmaWxlcyktPlxuICAgICAgY29uc29sZS5sb2cgJ2ZpbGU6ICcsIGZpbGVzXG5cbiAgb3ZlcjogKG92ZXIpLT5cblxuXG4gIGRyb3A6IChmaWxlcyk9PlxuICAgIGNvbnNvbGUubG9nICdkcm9wJywgZmlsZXMubGVuZ3RoLCBmaWxlc1xuICAgIGlmIGZpbGVzLmxlbmd0aFxuICAgICAgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKVxuICAgICAgXG4gICAgICByZWFkZXIub25sb2FkID0gKGV2ZW50KT0+XG4gICAgICAgIEBhdmF0YXJUZW1wbGF0ZS5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoJ2ltZycpLnNyYyA9IGV2ZW50LnRhcmdldC5yZXN1bHRcbiAgICAgICAgYXZhdGFyID0gZG9jdW1lbnQuaW1wb3J0Tm9kZSBAYXZhdGFyVGVtcGxhdGUuY29udGVudCwgdHJ1ZVxuICAgICAgICBwcmV2ID0gQGZpbGVTZWxlY3Rvci5wcmV2KClcbiAgICAgICAgaWYgcHJldi5oYXNDbGFzcygnY3VycmVudC1hdmF0YXInKVxuICAgICAgICAgIHByZXYucmVtb3ZlKClcbiAgICAgICAgQGZpbGVTZWxlY3Rvci5iZWZvcmUgYXZhdGFyXG4gICAgICAgIEBmaWxlU2VsZWN0b3IucHJldigpLmZpbmQoJy5jbG9zZScpLm9uICdjbGljaycsIEByZW1vdmVBdmF0YXJcbiAgICAgIFxuICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwgZmlsZXNbMF1cblxuICByZW1vdmVBdmF0YXI6IChldmVudCk9PlxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcbiAgICBAZmlsZVNlbGVjdG9yLnByZXYoKS5yZW1vdmUoKVxuICAgIEBmaWxlLnJlcGxhY2VXaXRoIEBmaWxlLnZhbCgnJykuY2xvbmUodHJ1ZSlcbiAgICBAZmlsZSA9IEBmb3JtLmZpbmQgJyNyZWdpc3RyYXRpb24tYXZhdGFyJ1xuXG4gIGF2YXRhclNlbGVjdGVkOiAoZXZlbnQpPT5cbiAgICBmaWxlcyA9IEZpbGVBUEkuZ2V0RmlsZXMoZXZlbnQpXG5cbiAgICBleHQgPSBmaWxlc1swXVsnbmFtZSddLnN1YnN0cmluZyhmaWxlc1swXVsnbmFtZSddLmxhc3RJbmRleE9mKCcuJykgKyAxKS50b0xvd2VyQ2FzZSgpXG4gICAgaWYgKGZpbGVzWzBdICYmIChleHQgPT0gXCJnaWZcIiB8fCBleHQgPT0gXCJwbmdcIiB8fCBleHQgPT0gXCJqcGVnXCIgfHwgZXh0ID09IFwianBnXCIpKVxuICAgICAgICBcbiAgICAgIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKClcbiAgICAgIHJlYWRlci5vbmxvYWQgPSAoZXZlbnQpPT5cbiAgICAgICAgXG4gICAgICAgIEBhdmF0YXJUZW1wbGF0ZS5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoJ2ltZycpLnNyYyA9IGV2ZW50LnRhcmdldC5yZXN1bHRcbiAgICAgICAgYXZhdGFyID0gZG9jdW1lbnQuaW1wb3J0Tm9kZSBAYXZhdGFyVGVtcGxhdGUuY29udGVudCwgdHJ1ZVxuICAgICAgICBwcmV2ID0gQGZpbGVTZWxlY3Rvci5wcmV2KClcbiAgICAgICAgaWYgcHJldi5oYXNDbGFzcygnY3VycmVudC1hdmF0YXInKVxuICAgICAgICAgIHByZXYucmVtb3ZlKClcbiAgICAgICAgQGZpbGVTZWxlY3Rvci5iZWZvcmUgYXZhdGFyXG4gICAgICAgIEBmaWxlU2VsZWN0b3IucHJldigpLmZpbmQoJy5jbG9zZScpLm9uICdjbGljaycsIEByZW1vdmVBdmF0YXJcblxuICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwgZmlsZXNbMF1cblxuXG4gIGFmdGVyQ2hlY2s6IChldmVudCk9PlxuICAgIFxuICAgIGlmIEBmb3JtLmZpbmQoJ2lucHV0LnVpLXN0YXRlLWVycm9yLCBzZWxlY3QudWktc3RhdGUtZXJyb3IsIHRleHRhcmVhLnVpLXN0YXRlLWVycm9yJykubGVuZ3RoID4gMFxuICAgICAgcmV0dXJuIGZhbHNlXG5cbiAgICBkcm9wX2Rvd25fZXJyID0gZmFsc2VcblxuICAgIGZvciBpbnB1dCBpbiBAZm9ybS5maW5kKCcuZHJvcGRvd24td2lkZ2V0JylcbiAgICAgIGlmICFpbnB1dC5jb250cm9sbGVyLnZhbGlkYXRlKClcbiAgICAgICAgZHJvcF9kb3duX2VyciA9IHRydWVcblxuICAgIGlmIGRyb3BfZG93bl9lcnJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcbiAgICAgIHJldHVybiBmYWxzZVxuXG5cbiQoZG9jdW1lbnQpLnJlYWR5IC0+XG4gIG5ldyBQZXJzb25hbERhdGEoKSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==