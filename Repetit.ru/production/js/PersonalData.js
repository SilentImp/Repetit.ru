var PersonalData,__bind=function(t,e){return function(){return t.apply(e,arguments)}};PersonalData=function(){function t(){this.afterCheck=__bind(this.afterCheck,this),this.avatarSelected=__bind(this.avatarSelected,this),this.removeAvatar=__bind(this.removeAvatar,this),this.drop=__bind(this.drop,this),this.checkDate=__bind(this.checkDate,this);var t,e;if(this.form=$("form.panel"),1!==this.form.length)throw{error:"не найдена форма"};this.file=this.form.find("#registration-avatar"),this.avatarTemplate=document.getElementById("current-avatar-template"),this.fileSelector=$(".file-selector"),FileAPI.event.on(document.getElementById("registration-avatar"),"change",this.avatarSelected),$(document).dnd(this.over,this.drop),FileAPI.event.on(document,"drop",this.droped),$(".sertificats").fileapi({url:"http://websaints.net/test.php",duplicate:!1,accept:"image/*",autoUpload:!1,multiple:!0,elements:{ctrl:{upload:".add-sertificat label"},list:".sertificat-list"}}),this.form.h5Validate(),this.form.on("submit",this.afterCheck),this.mounth_widget=this.form.find(".month.dropdown-widget"),this.month=this.mounth_widget.find("select"),this.year_widget=this.form.find(".year.dropdown-widget"),this.year=this.year_widget.find("select"),this.day=this.form.find("input.day"),this.day.on("change",this.checkDate),this.month.on("change",this.checkDate),this.year.on("change",this.checkDate),t=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("city"),queryTokenizer:Bloodhound.tokenizers.whitespace,prefetch:"https://dl.dropboxusercontent.com/u/20810772/citys.json"}),t.initialize(),$("#city").typeahead({hint:!0,highlight:!0,minLength:1},{name:"locations",displayKey:"city",source:t.ttAdapter(),templates:{suggestion:Handlebars.compile("<p><b>{{region}}</b>{{city}}</p>")}}),e=new Bloodhound({datumTokenizer:function(t){return Bloodhound.tokenizers.whitespace(t.title)},queryTokenizer:Bloodhound.tokenizers.whitespace,local:[{title:"Andorra"},{title:"UnitedArabEmirates"},{title:"Afghanistan"},{title:"AntiguaandBarbuda"},{title:"Anguilla"},{title:"Albania"},{title:"Armenia"},{title:"Angola"},{title:"Antarctica"}]}),e.initialize(),$("#univercity").typeahead({hint:!0,highlight:!0,minLength:1},{name:"univercitys",displayKey:"title",source:e.ttAdapter(),templates:{suggestion:Handlebars.compile("<p>{{title}}</p>")}})}return t.prototype.checkDate=function(){var t,e;return t=parseInt(this.day.val().trim(),10),1>t||isNaN(t)?void this.day.val(1):this.mounth_widget.hasClass("unchanged")||this.year_widget.hasClass("unchanged")?t>31?this.day.val(31):void 0:(e=parseInt(moment(this.year.val()+"-"+(parseInt(this.month.val(),10)+1),"YYYY-MM").daysInMonth(),10),void(t>e&&this.day.val(e)))},t.prototype.droped=function(t){return t.preventDefault(),console.log("droped",t),FileAPI.getDropFiles(t,function(t){return console.log("file: ",t)})},t.prototype.over=function(){},t.prototype.drop=function(t){var e;return console.log("drop",t.length,t),t.length?(e=new FileReader,e.onload=function(t){return function(e){var i,r;return t.avatarTemplate.content.querySelector("img").src=e.target.result,i=document.importNode(t.avatarTemplate.content,!0),r=t.fileSelector.prev(),r.hasClass("current-avatar")&&r.remove(),t.fileSelector.before(i),t.fileSelector.prev().find(".close").on("click",t.removeAvatar)}}(this),e.readAsDataURL(t[0])):void 0},t.prototype.removeAvatar=function(t){return t.preventDefault(),this.fileSelector.prev().remove(),this.file.replaceWith(this.file.val("").clone(!0)),this.file=this.form.find("#registration-avatar")},t.prototype.avatarSelected=function(t){var e,i,r;return i=FileAPI.getFiles(t),e=i[0].name.substring(i[0].name.lastIndexOf(".")+1).toLowerCase(),!i[0]||"gif"!==e&&"png"!==e&&"jpeg"!==e&&"jpg"!==e?void 0:(r=new FileReader,r.onload=function(t){return function(e){var i,r;return t.avatarTemplate.content.querySelector("img").src=e.target.result,i=document.importNode(t.avatarTemplate.content,!0),r=t.fileSelector.prev(),r.hasClass("current-avatar")&&r.remove(),t.fileSelector.before(i),t.fileSelector.prev().find(".close").on("click",t.removeAvatar)}}(this),r.readAsDataURL(i[0]))},t.prototype.afterCheck=function(t){var e,i,r,a,n;if(this.form.find("input.ui-state-error, select.ui-state-error, textarea.ui-state-error").length>0)return!1;for(e=!1,n=this.form.find(".dropdown-widget"),r=0,a=n.length;a>r;r++)i=n[r],i.controller.validate()||(e=!0);return e?(t.preventDefault(),!1):void 0},t}(),$(document).ready(function(){return new PersonalData});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlBlcnNvbmFsRGF0YS5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsR0FBQSxjQUFBLE9BQUEsU0FBQSxFQUFBLEdBQUEsTUFBQSxZQUFBLE1BQUEsR0FBQSxNQUFBLEVBQUEsWUFBQSxjQUFBLFdBQ2UsUUFBQSxLQUNYLEtBQUEsV0FBQSxPQUFBLEtBQUEsV0FBQSxNQUFBLEtBQUEsZUFBQSxPQUFBLEtBQUEsZUFBQSxNQUFBLEtBQUEsYUFBQSxPQUFBLEtBQUEsYUFBQSxNQUFBLEtBQUEsS0FBQSxPQUFBLEtBQUEsS0FBQSxNQUFBLEtBQUEsVUFBQSxPQUFBLEtBQUEsVUFBQSxLQUFBLElBQUEsR0FBQSxDQUNBLElBREEsS0FBQyxLQUFPLEVBQUUsY0FDUyxJQUFoQixLQUFDLEtBQUssT0FDUCxNQUFPLE1BQU8sbUJBRWhCLE1BQUMsS0FBTyxLQUFDLEtBQUssS0FBSyx3QkFDbkIsS0FBQyxlQUFpQixTQUFTLGVBQWUsMkJBQzFDLEtBQUMsYUFBZSxFQUFFLGtCQUVsQixRQUFRLE1BQU0sR0FBRyxTQUFTLGVBQWUsdUJBQXdCLFNBQVUsS0FBQyxnQkFDNUUsRUFBRSxVQUFVLElBQUksS0FBQyxLQUFNLEtBQUMsTUFFeEIsUUFBUSxNQUFNLEdBQUcsU0FBVSxPQUFRLEtBQUMsUUFFcEMsRUFBRSxnQkFBZ0IsU0FFaEIsSUFBSyxnQ0FDTCxXQUFXLEVBQ1gsT0FBUSxVQUNSLFlBQVksRUFDWixVQUFVLEVBQ1YsVUFDRSxNQUNFLE9BQVEseUJBQ1YsS0FBTSxzQkFFVixLQUFDLEtBQUssYUFDTixLQUFDLEtBQUssR0FBRyxTQUFVLEtBQUMsWUFFcEIsS0FBQyxjQUFnQixLQUFDLEtBQUssS0FBSywwQkFDNUIsS0FBQyxNQUFTLEtBQUMsY0FBYyxLQUFLLFVBQzlCLEtBQUMsWUFBYyxLQUFDLEtBQUssS0FBSyx5QkFDMUIsS0FBQyxLQUFRLEtBQUMsWUFBWSxLQUFLLFVBQzNCLEtBQUMsSUFBTSxLQUFDLEtBQUssS0FBSyxhQUVsQixLQUFDLElBQUksR0FBRyxTQUFVLEtBQUMsV0FDbkIsS0FBQyxNQUFNLEdBQUcsU0FBVSxLQUFDLFdBQ3JCLEtBQUMsS0FBSyxHQUFHLFNBQVUsS0FBQyxXQUVwQixFQUFnQixHQUFBLGFBQ2QsZUFBZ0IsV0FBVyxXQUFXLElBQUksV0FBVyxRQUNyRCxlQUFnQixXQUFXLFdBQVcsV0FDdEMsU0FBVSw0REFFWixFQUFVLGFBRVYsRUFBRSxTQUFTLFdBQ1QsTUFBTSxFQUNOLFdBQVcsRUFDWCxVQUFXLElBRVgsS0FBTSxZQUNOLFdBQVksT0FDWixPQUFRLEVBQVUsWUFDbEIsV0FDRSxXQUFZLFdBQVcsUUFBUSx1Q0FFbkMsRUFBa0IsR0FBQSxhQUNoQixlQUFnQixTQUFDLEdBQ2YsTUFBTyxZQUFXLFdBQVcsV0FBVyxFQUFLLFFBQy9DLGVBQWdCLFdBQVcsV0FBVyxXQUN0QyxRQUFTLE1BQVEsWUFBWSxNQUFRLHVCQUF1QixNQUFRLGdCQUFnQixNQUFRLHNCQUFzQixNQUFRLGFBQWEsTUFBUSxZQUFZLE1BQVEsWUFBWSxNQUFRLFdBQVcsTUFBUSxpQkFFNU0sRUFBWSxhQUVaLEVBQUUsZUFBZSxXQUNmLE1BQU0sRUFDTixXQUFXLEVBQ1gsVUFBVyxJQUVYLEtBQU0sY0FDTixXQUFZLFFBQ1osT0FBUSxFQUFZLFlBQ3BCLFdBQ0UsV0FBWSxXQUFXLFFBQVEsNkJBMUVyQyxHQUFBLFVBNkVBLFVBQVcsV0FDVCxHQUFBLEdBQUEsQ0FFQSxPQUZBLEdBQU0sU0FBUyxLQUFDLElBQUksTUFBTSxPQUFRLElBRTNCLEVBQUosR0FBUyxNQUFNLE9BQ2hCLE1BQUMsSUFBSSxJQUFJLEdBR1IsS0FBRSxjQUFjLFNBQVMsY0FBZ0IsS0FBRSxZQUFZLFNBQVMsYUFRaEUsRUFBSSxHQUNMLEtBQUMsSUFBSSxJQUFJLElBRFgsUUFORSxFQUFPLFNBQVMsT0FBTyxLQUFDLEtBQUssTUFBTSxLQUFLLFNBQVMsS0FBQyxNQUFNLE1BQU0sSUFBSSxHQUFJLFdBQVcsY0FBZSxTQUM3RixFQUFJLEdBQ0wsS0FBQyxJQUFJLElBQUksTUF4RmYsRUFBQSxVQStGQSxPQUFRLFNBQUMsU0FDUCxHQUFNLGlCQUNOLFFBQVEsSUFBSSxTQUFVLEdBQ3RCLFFBQVEsYUFBYSxFQUFPLFNBQUMsU0FDM0IsU0FBUSxJQUFJLFNBQVUsTUFuRzFCLEVBQUEsVUFxR0EsS0FBTSxhQXJHTixFQUFBLFVBd0dBLEtBQU0sU0FBQyxHQUNMLEdBQUEsRUFDQSxPQURBLFNBQVEsSUFBSSxPQUFRLEVBQU0sT0FBUSxHQUMvQixFQUFNLFFBQ1AsRUFBYSxHQUFBLFlBRWIsRUFBTyxPQUFTLFNBQUEsU0FBQSxVQUFDLEdBQ2YsR0FBQSxHQUFBLFFBQUEsR0FBQyxlQUFlLFFBQVEsY0FBYyxPQUFPLElBQU0sRUFBTSxPQUFPLE9BQ2hFLEVBQVMsU0FBUyxXQUFXLEVBQUMsZUFBZSxTQUFTLEdBQ3RELEVBQU8sRUFBQyxhQUFhLE9BQ2xCLEVBQUssU0FBUyxtQkFDZixFQUFLLFNBQ1AsRUFBQyxhQUFhLE9BQU8sR0FDckIsRUFBQyxhQUFhLE9BQU8sS0FBSyxVQUFVLEdBQUcsUUFBUyxFQUFDLGdCQVBuQyxNQVNoQixFQUFPLGNBQWMsRUFBTSxLQVo3QixRQTFHRixFQUFBLFVBd0hBLGFBQWMsU0FBQyxTQUNiLEdBQU0saUJBQ04sS0FBQyxhQUFhLE9BQU8sU0FDckIsS0FBQyxLQUFLLFlBQVksS0FBQyxLQUFLLElBQUksSUFBSSxPQUFNLElBQ3RDLEtBQUMsS0FBTyxLQUFDLEtBQUssS0FBSyx5QkE1SHJCLEVBQUEsVUE4SEEsZUFBZ0IsU0FBQyxHQUNmLEdBQUEsR0FBQSxFQUFBLENBR0EsT0FIQSxHQUFRLFFBQVEsU0FBUyxHQUV6QixFQUFNLEVBQU0sR0FBRyxLQUFRLFVBQVUsRUFBTSxHQUFHLEtBQVEsWUFBWSxLQUFPLEdBQUcsZUFDcEUsRUFBTSxJQUFjLFFBQVAsR0FBdUIsUUFBUCxHQUF1QixTQUFQLEdBQXdCLFFBQVAsRUFBbEUsUUFFRSxFQUFhLEdBQUEsWUFDYixFQUFPLE9BQVMsU0FBQSxTQUFBLFVBQUMsR0FFZixHQUFBLEdBQUEsUUFBQSxHQUFDLGVBQWUsUUFBUSxjQUFjLE9BQU8sSUFBTSxFQUFNLE9BQU8sT0FDaEUsRUFBUyxTQUFTLFdBQVcsRUFBQyxlQUFlLFNBQVMsR0FDdEQsRUFBTyxFQUFDLGFBQWEsT0FDbEIsRUFBSyxTQUFTLG1CQUNmLEVBQUssU0FDUCxFQUFDLGFBQWEsT0FBTyxHQUNyQixFQUFDLGFBQWEsT0FBTyxLQUFLLFVBQVUsR0FBRyxRQUFTLEVBQUMsZ0JBUm5DLE1BVWhCLEVBQU8sY0FBYyxFQUFNLE1BL0kvQixFQUFBLFVBa0pBLFdBQVksU0FBQyxHQUVYLEdBQUEsR0FBQSxFQUFBLEVBQUEsRUFBQSxDQUFBLElBQUcsS0FBQyxLQUFLLEtBQUssd0VBQXdFLE9BQVMsRUFDN0YsT0FBTyxDQUlULEtBRkEsR0FBZ0IsRUFFaEIsRUFBQSxLQUFBLEtBQUEsS0FBQSxvQkFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLE9BQUEsRUFBQSxFQUFBLFdBQ0ssRUFBTyxXQUFXLGFBQ25CLEdBQWdCLEVBRXBCLE9BQUcsSUFDRCxFQUFNLGtCQUNDLEdBRlQsYUE5SkosRUFtS0UsVUFBVSxNQUFNLGlCQUNaLElBQUEiLCJmaWxlIjoiUGVyc29uYWxEYXRhLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgUGVyc29uYWxEYXRhXG4gIGNvbnN0cnVjdG9yOiAtPlxuICAgIEBmb3JtID0gJCAnZm9ybS5wYW5lbCdcbiAgICBpZiBAZm9ybS5sZW5ndGggIT0gMVxuICAgICAgdGhyb3cge2Vycm9yOiAn0L3QtSDQvdCw0LnQtNC10L3QsCDRhNC+0YDQvNCwJ31cblxuICAgIEBmaWxlID0gQGZvcm0uZmluZCAnI3JlZ2lzdHJhdGlvbi1hdmF0YXInXG4gICAgQGF2YXRhclRlbXBsYXRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQgJ2N1cnJlbnQtYXZhdGFyLXRlbXBsYXRlJ1xuICAgIEBmaWxlU2VsZWN0b3IgPSAkICcuZmlsZS1zZWxlY3RvcidcblxuICAgIEZpbGVBUEkuZXZlbnQub24gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlZ2lzdHJhdGlvbi1hdmF0YXInKSwgJ2NoYW5nZScsIEBhdmF0YXJTZWxlY3RlZFxuICAgICQoZG9jdW1lbnQpLmRuZCBAb3ZlciwgQGRyb3BcblxuICAgIEZpbGVBUEkuZXZlbnQub24gZG9jdW1lbnQsICdkcm9wJywgQGRyb3BlZFxuXG4gICAgJCgnLnNlcnRpZmljYXRzJykuZmlsZWFwaVxuICAgICAgIyB1cmw6IEBmb3JtLmF0dHIoJ2FjdGlvbicpLFxuICAgICAgdXJsOiAnaHR0cDovL3dlYnNhaW50cy5uZXQvdGVzdC5waHAnXG4gICAgICBkdXBsaWNhdGU6IGZhbHNlLFxuICAgICAgYWNjZXB0OiAnaW1hZ2UvKicsXG4gICAgICBhdXRvVXBsb2FkOiBmYWxzZSxcbiAgICAgIG11bHRpcGxlOiB0cnVlLFxuICAgICAgZWxlbWVudHM6XG4gICAgICAgIGN0cmw6IFxuICAgICAgICAgIHVwbG9hZDogJy5hZGQtc2VydGlmaWNhdCBsYWJlbCdcbiAgICAgICAgbGlzdDogJy5zZXJ0aWZpY2F0LWxpc3QnXG5cbiAgICBAZm9ybS5oNVZhbGlkYXRlKClcbiAgICBAZm9ybS5vbiAnc3VibWl0JywgQGFmdGVyQ2hlY2tcblxuICAgIEBtb3VudGhfd2lkZ2V0ID0gQGZvcm0uZmluZCAnLm1vbnRoLmRyb3Bkb3duLXdpZGdldCdcbiAgICBAbW9udGggPSAgQG1vdW50aF93aWRnZXQuZmluZCAnc2VsZWN0J1xuICAgIEB5ZWFyX3dpZGdldCA9IEBmb3JtLmZpbmQgJy55ZWFyLmRyb3Bkb3duLXdpZGdldCdcbiAgICBAeWVhciA9ICBAeWVhcl93aWRnZXQuZmluZCAnc2VsZWN0J1xuICAgIEBkYXkgPSBAZm9ybS5maW5kICdpbnB1dC5kYXknXG4gICAgXG4gICAgQGRheS5vbiAnY2hhbmdlJywgQGNoZWNrRGF0ZVxuICAgIEBtb250aC5vbiAnY2hhbmdlJywgQGNoZWNrRGF0ZVxuICAgIEB5ZWFyLm9uICdjaGFuZ2UnLCBAY2hlY2tEYXRlXG5cbiAgICBsb2NhdGlvbnMgPSBuZXcgQmxvb2Rob3VuZFxuICAgICAgZGF0dW1Ub2tlbml6ZXI6IEJsb29kaG91bmQudG9rZW5pemVycy5vYmoud2hpdGVzcGFjZShcImNpdHlcIiksXG4gICAgICBxdWVyeVRva2VuaXplcjogQmxvb2Rob3VuZC50b2tlbml6ZXJzLndoaXRlc3BhY2UsXG4gICAgICBwcmVmZXRjaDogXCJodHRwczovL2RsLmRyb3Bib3h1c2VyY29udGVudC5jb20vdS8yMDgxMDc3Mi9jaXR5cy5qc29uXCJcbiAgICBcbiAgICBsb2NhdGlvbnMuaW5pdGlhbGl6ZSgpXG5cbiAgICAkKCcjY2l0eScpLnR5cGVhaGVhZFxuICAgICAgaGludDogdHJ1ZVxuICAgICAgaGlnaGxpZ2h0OiB0cnVlXG4gICAgICBtaW5MZW5ndGg6IDFcbiAgICAsXG4gICAgICBuYW1lOiAnbG9jYXRpb25zJ1xuICAgICAgZGlzcGxheUtleTogJ2NpdHknLFxuICAgICAgc291cmNlOiBsb2NhdGlvbnMudHRBZGFwdGVyKClcbiAgICAgIHRlbXBsYXRlczpcbiAgICAgICAgc3VnZ2VzdGlvbjogSGFuZGxlYmFycy5jb21waWxlKCc8cD48Yj57e3JlZ2lvbn19PC9iPnt7Y2l0eX19PC9wPicpXG5cbiAgICB1bml2ZXJjaXR5cyA9IG5ldyBCbG9vZGhvdW5kXG4gICAgICBkYXR1bVRva2VuaXplcjogKGRhdGEpLT5cbiAgICAgICAgcmV0dXJuIEJsb29kaG91bmQudG9rZW5pemVycy53aGl0ZXNwYWNlKGRhdGEudGl0bGUpXG4gICAgICBxdWVyeVRva2VuaXplcjogQmxvb2Rob3VuZC50b2tlbml6ZXJzLndoaXRlc3BhY2UsXG4gICAgICBsb2NhbDogW3tcInRpdGxlXCI6XCJBbmRvcnJhXCJ9LHtcInRpdGxlXCI6XCJVbml0ZWRBcmFiRW1pcmF0ZXNcIn0se1widGl0bGVcIjpcIkFmZ2hhbmlzdGFuXCJ9LHtcInRpdGxlXCI6XCJBbnRpZ3VhYW5kQmFyYnVkYVwifSx7XCJ0aXRsZVwiOlwiQW5ndWlsbGFcIn0se1widGl0bGVcIjpcIkFsYmFuaWFcIn0se1widGl0bGVcIjpcIkFybWVuaWFcIn0se1widGl0bGVcIjpcIkFuZ29sYVwifSx7XCJ0aXRsZVwiOlwiQW50YXJjdGljYVwifV1cblxuICAgIHVuaXZlcmNpdHlzLmluaXRpYWxpemUoKVxuXG4gICAgJCgnI3VuaXZlcmNpdHknKS50eXBlYWhlYWRcbiAgICAgIGhpbnQ6IHRydWVcbiAgICAgIGhpZ2hsaWdodDogdHJ1ZVxuICAgICAgbWluTGVuZ3RoOiAxXG4gICAgLFxuICAgICAgbmFtZTogJ3VuaXZlcmNpdHlzJ1xuICAgICAgZGlzcGxheUtleTogJ3RpdGxlJyxcbiAgICAgIHNvdXJjZTogdW5pdmVyY2l0eXMudHRBZGFwdGVyKClcbiAgICAgIHRlbXBsYXRlczpcbiAgICAgICAgc3VnZ2VzdGlvbjogSGFuZGxlYmFycy5jb21waWxlKCc8cD57e3RpdGxlfX08L3A+JylcblxuXG4gIGNoZWNrRGF0ZTogKGV2ZW50KT0+XG4gICAgZGF5ID0gcGFyc2VJbnQgQGRheS52YWwoKS50cmltKCksIDEwXG5cbiAgICBpZiBkYXk8MSB8fCBpc05hTihkYXkpXG4gICAgICBAZGF5LnZhbCAxXG4gICAgICByZXR1cm5cblxuICAgIGlmICFAbW91bnRoX3dpZGdldC5oYXNDbGFzcygndW5jaGFuZ2VkJykgJiYgIUB5ZWFyX3dpZGdldC5oYXNDbGFzcygndW5jaGFuZ2VkJylcblxuICAgICAgZGF5cyA9IHBhcnNlSW50IG1vbWVudChAeWVhci52YWwoKStcIi1cIisocGFyc2VJbnQoQG1vbnRoLnZhbCgpLDEwKSsxKSwgXCJZWVlZLU1NXCIpLmRheXNJbk1vbnRoKCksIDEwXG4gICAgICBpZiBkYXk+ZGF5c1xuICAgICAgICBAZGF5LnZhbCBkYXlzXG4gICAgICAgIFxuICAgICAgcmV0dXJuXG5cbiAgICBpZiBkYXk+MzFcbiAgICAgIEBkYXkudmFsIDMxXG5cbiAgZHJvcGVkOiAoZXZlbnQpLT5cbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpXG4gICAgY29uc29sZS5sb2cgJ2Ryb3BlZCcsIGV2ZW50XG4gICAgRmlsZUFQSS5nZXREcm9wRmlsZXMgZXZlbnQsIChmaWxlcyktPlxuICAgICAgY29uc29sZS5sb2cgJ2ZpbGU6ICcsIGZpbGVzXG5cbiAgb3ZlcjogKG92ZXIpLT5cblxuXG4gIGRyb3A6IChmaWxlcyk9PlxuICAgIGNvbnNvbGUubG9nICdkcm9wJywgZmlsZXMubGVuZ3RoLCBmaWxlc1xuICAgIGlmIGZpbGVzLmxlbmd0aFxuICAgICAgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKVxuICAgICAgXG4gICAgICByZWFkZXIub25sb2FkID0gKGV2ZW50KT0+XG4gICAgICAgIEBhdmF0YXJUZW1wbGF0ZS5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoJ2ltZycpLnNyYyA9IGV2ZW50LnRhcmdldC5yZXN1bHRcbiAgICAgICAgYXZhdGFyID0gZG9jdW1lbnQuaW1wb3J0Tm9kZSBAYXZhdGFyVGVtcGxhdGUuY29udGVudCwgdHJ1ZVxuICAgICAgICBwcmV2ID0gQGZpbGVTZWxlY3Rvci5wcmV2KClcbiAgICAgICAgaWYgcHJldi5oYXNDbGFzcygnY3VycmVudC1hdmF0YXInKVxuICAgICAgICAgIHByZXYucmVtb3ZlKClcbiAgICAgICAgQGZpbGVTZWxlY3Rvci5iZWZvcmUgYXZhdGFyXG4gICAgICAgIEBmaWxlU2VsZWN0b3IucHJldigpLmZpbmQoJy5jbG9zZScpLm9uICdjbGljaycsIEByZW1vdmVBdmF0YXJcbiAgICAgIFxuICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwgZmlsZXNbMF1cblxuICByZW1vdmVBdmF0YXI6IChldmVudCk9PlxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcbiAgICBAZmlsZVNlbGVjdG9yLnByZXYoKS5yZW1vdmUoKVxuICAgIEBmaWxlLnJlcGxhY2VXaXRoIEBmaWxlLnZhbCgnJykuY2xvbmUodHJ1ZSlcbiAgICBAZmlsZSA9IEBmb3JtLmZpbmQgJyNyZWdpc3RyYXRpb24tYXZhdGFyJ1xuXG4gIGF2YXRhclNlbGVjdGVkOiAoZXZlbnQpPT5cbiAgICBmaWxlcyA9IEZpbGVBUEkuZ2V0RmlsZXMoZXZlbnQpXG5cbiAgICBleHQgPSBmaWxlc1swXVsnbmFtZSddLnN1YnN0cmluZyhmaWxlc1swXVsnbmFtZSddLmxhc3RJbmRleE9mKCcuJykgKyAxKS50b0xvd2VyQ2FzZSgpXG4gICAgaWYgKGZpbGVzWzBdICYmIChleHQgPT0gXCJnaWZcIiB8fCBleHQgPT0gXCJwbmdcIiB8fCBleHQgPT0gXCJqcGVnXCIgfHwgZXh0ID09IFwianBnXCIpKVxuICAgICAgICBcbiAgICAgIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKClcbiAgICAgIHJlYWRlci5vbmxvYWQgPSAoZXZlbnQpPT5cbiAgICAgICAgXG4gICAgICAgIEBhdmF0YXJUZW1wbGF0ZS5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoJ2ltZycpLnNyYyA9IGV2ZW50LnRhcmdldC5yZXN1bHRcbiAgICAgICAgYXZhdGFyID0gZG9jdW1lbnQuaW1wb3J0Tm9kZSBAYXZhdGFyVGVtcGxhdGUuY29udGVudCwgdHJ1ZVxuICAgICAgICBwcmV2ID0gQGZpbGVTZWxlY3Rvci5wcmV2KClcbiAgICAgICAgaWYgcHJldi5oYXNDbGFzcygnY3VycmVudC1hdmF0YXInKVxuICAgICAgICAgIHByZXYucmVtb3ZlKClcbiAgICAgICAgQGZpbGVTZWxlY3Rvci5iZWZvcmUgYXZhdGFyXG4gICAgICAgIEBmaWxlU2VsZWN0b3IucHJldigpLmZpbmQoJy5jbG9zZScpLm9uICdjbGljaycsIEByZW1vdmVBdmF0YXJcblxuICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwgZmlsZXNbMF1cblxuXG4gIGFmdGVyQ2hlY2s6IChldmVudCk9PlxuICAgIFxuICAgIGlmIEBmb3JtLmZpbmQoJ2lucHV0LnVpLXN0YXRlLWVycm9yLCBzZWxlY3QudWktc3RhdGUtZXJyb3IsIHRleHRhcmVhLnVpLXN0YXRlLWVycm9yJykubGVuZ3RoID4gMFxuICAgICAgcmV0dXJuIGZhbHNlXG5cbiAgICBkcm9wX2Rvd25fZXJyID0gZmFsc2VcblxuICAgIGZvciBpbnB1dCBpbiBAZm9ybS5maW5kKCcuZHJvcGRvd24td2lkZ2V0JylcbiAgICAgIGlmICFpbnB1dC5jb250cm9sbGVyLnZhbGlkYXRlKClcbiAgICAgICAgZHJvcF9kb3duX2VyciA9IHRydWVcblxuICAgIGlmIGRyb3BfZG93bl9lcnJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcbiAgICAgIHJldHVybiBmYWxzZVxuXG5cbiQoZG9jdW1lbnQpLnJlYWR5IC0+XG4gIG5ldyBQZXJzb25hbERhdGEoKSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==