var PersonalData,__bind=function(e,t){return function(){return e.apply(t,arguments)}};PersonalData=function(){function e(){if(this.afterCheck=__bind(this.afterCheck,this),this.avatarSelected=__bind(this.avatarSelected,this),this.removeAvatar=__bind(this.removeAvatar,this),this.drop=__bind(this.drop,this),this.over=__bind(this.over,this),this.droped=__bind(this.droped,this),this.form=$("form.panel"),1!==this.form.length)throw{error:"не найдена форма"};this.file=this.form.find("#registration-avatar"),this.avatarTemplate=document.getElementById("current-avatar-template"),this.fileSelector=$(".file-selector"),FileAPI.event.on(document.getElementById("registration-avatar"),"change",this.avatarSelected),$(document).dnd(this.over,this.drop),FileAPI.event.on(document,"drop",this.droped),this.form.h5Validate(),this.form.on("submit",this.afterCheck)}return e.prototype.droped=function(e){return e.preventDefault(),console.log("droped",e),FileAPI.getDropFiles(e,function(e){return console.log("file: ",e)})},e.prototype.over=function(){},e.prototype.drop=function(e){var t;return console.log("drop",e.length,e),e.length?(t=new FileReader,t.onload=function(e){return function(t){var r,o;return e.avatarTemplate.content.querySelector("img").src=t.target.result,r=document.importNode(e.avatarTemplate.content,!0),o=e.fileSelector.prev(),o.hasClass("current-avatar")&&o.remove(),e.fileSelector.before(r),e.fileSelector.prev().find(".close").on("click",e.removeAvatar)}}(this),t.readAsDataURL(e[0])):void 0},e.prototype.removeAvatar=function(e){return e.preventDefault(),this.fileSelector.prev().remove(),this.file.replaceWith(this.file.val("").clone(!0)),this.file=this.form.find("#registration-avatar")},e.prototype.avatarSelected=function(e){var t,r,o;return r=FileAPI.getFiles(e),t=r[0].name.substring(r[0].name.lastIndexOf(".")+1).toLowerCase(),!r[0]||"gif"!==t&&"png"!==t&&"jpeg"!==t&&"jpg"!==t?void 0:(o=new FileReader,o.onload=function(e){return function(t){var r,o;return e.avatarTemplate.content.querySelector("img").src=t.target.result,r=document.importNode(e.avatarTemplate.content,!0),o=e.fileSelector.prev(),o.hasClass("current-avatar")&&o.remove(),e.fileSelector.before(r),e.fileSelector.prev().find(".close").on("click",e.removeAvatar)}}(this),o.readAsDataURL(r[0]))},e.prototype.afterCheck=function(e){var t,r,o,n,a;if(this.form.find("input.ui-state-error, select.ui-state-error, textarea.ui-state-error").length>0)return!1;for(t=!1,a=this.form.find(".dropdown-widget"),o=0,n=a.length;n>o;o++)r=a[o],r.controller.validate()||(console.log("ошибка"),t=!0);return t?(e.preventDefault(),!1):void 0},e}(),$(document).ready(function(){return new PersonalData});
//# sourceMappingURL=data:application/json;base64,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QUFBLEVBQUEsRUFBQSxFQUFBLENBQUEsSUFBRyxLQUFDLEtBQUssS0FBSyx3RUFBd0UsT0FBUyxFQUM3RixPQUFPLENBR1QsS0FEQSxHQUFnQixFQUNoQixFQUFBLEtBQUEsS0FBQSxLQUFBLG9CQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsT0FBQSxFQUFBLEVBQUEsV0FDSyxFQUFPLFdBQVcsYUFDbkIsUUFBUSxJQUFJLFVBQ1osR0FBZ0IsRUFFcEIsT0FBRyxJQUNELEVBQU0sa0JBQ0MsR0FGVCxhQWxGSixFQXVGRSxVQUFVLE1BQU0saUJBQ1osSUFBQSIsImZpbGUiOiJQZXJzb25hbERhdGEuanMiLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBQZXJzb25hbERhdGFcbiAgY29uc3RydWN0b3I6IC0+XG4gICAgQGZvcm0gPSAkICdmb3JtLnBhbmVsJ1xuICAgIGlmIEBmb3JtLmxlbmd0aCAhPSAxXG4gICAgICB0aHJvdyB7ZXJyb3I6ICfQvdC1INC90LDQudC00LXQvdCwINGE0L7RgNC80LAnfVxuXG4gICAgQGZpbGUgPSBAZm9ybS5maW5kICcjcmVnaXN0cmF0aW9uLWF2YXRhcidcbiAgICBAYXZhdGFyVGVtcGxhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCAnY3VycmVudC1hdmF0YXItdGVtcGxhdGUnXG4gICAgQGZpbGVTZWxlY3RvciA9ICQgJy5maWxlLXNlbGVjdG9yJ1xuXG4gICAgRmlsZUFQSS5ldmVudC5vbiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVnaXN0cmF0aW9uLWF2YXRhcicpLCAnY2hhbmdlJywgQGF2YXRhclNlbGVjdGVkXG4gICAgJChkb2N1bWVudCkuZG5kIEBvdmVyLCBAZHJvcFxuXG4gICAgRmlsZUFQSS5ldmVudC5vbiBkb2N1bWVudCwgJ2Ryb3AnLCBAZHJvcGVkXG5cbiAgICBAZm9ybS5oNVZhbGlkYXRlKClcbiAgICBAZm9ybS5vbiAnc3VibWl0JywgQGFmdGVyQ2hlY2tcblxuICBcblxuICBkcm9wZWQ6IChldmVudCk9PlxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcbiAgICBjb25zb2xlLmxvZyAnZHJvcGVkJywgZXZlbnRcbiAgICBGaWxlQVBJLmdldERyb3BGaWxlcyBldmVudCwgKGZpbGVzKS0+XG4gICAgICBjb25zb2xlLmxvZyAnZmlsZTogJywgZmlsZXNcblxuICBvdmVyOiAob3Zlcik9PlxuXG5cbiAgZHJvcDogKGZpbGVzKT0+XG4gICAgY29uc29sZS5sb2cgJ2Ryb3AnLCBmaWxlcy5sZW5ndGgsIGZpbGVzXG4gICAgaWYgZmlsZXMubGVuZ3RoXG4gICAgICByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpXG4gICAgICBcbiAgICAgIHJlYWRlci5vbmxvYWQgPSAoZXZlbnQpPT5cbiAgICAgICAgQGF2YXRhclRlbXBsYXRlLmNvbnRlbnQucXVlcnlTZWxlY3RvcignaW1nJykuc3JjID0gZXZlbnQudGFyZ2V0LnJlc3VsdFxuICAgICAgICBhdmF0YXIgPSBkb2N1bWVudC5pbXBvcnROb2RlIEBhdmF0YXJUZW1wbGF0ZS5jb250ZW50LCB0cnVlXG4gICAgICAgIHByZXYgPSBAZmlsZVNlbGVjdG9yLnByZXYoKVxuICAgICAgICBpZiBwcmV2Lmhhc0NsYXNzKCdjdXJyZW50LWF2YXRhcicpXG4gICAgICAgICAgcHJldi5yZW1vdmUoKVxuICAgICAgICBAZmlsZVNlbGVjdG9yLmJlZm9yZSBhdmF0YXJcbiAgICAgICAgQGZpbGVTZWxlY3Rvci5wcmV2KCkuZmluZCgnLmNsb3NlJykub24gJ2NsaWNrJywgQHJlbW92ZUF2YXRhclxuICAgICAgXG4gICAgICByZWFkZXIucmVhZEFzRGF0YVVSTCBmaWxlc1swXVxuXG4gIHJlbW92ZUF2YXRhcjogKGV2ZW50KT0+XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKVxuICAgIEBmaWxlU2VsZWN0b3IucHJldigpLnJlbW92ZSgpXG4gICAgQGZpbGUucmVwbGFjZVdpdGggQGZpbGUudmFsKCcnKS5jbG9uZSh0cnVlKVxuICAgIEBmaWxlID0gQGZvcm0uZmluZCAnI3JlZ2lzdHJhdGlvbi1hdmF0YXInXG5cbiAgYXZhdGFyU2VsZWN0ZWQ6IChldmVudCk9PlxuICAgIGZpbGVzID0gRmlsZUFQSS5nZXRGaWxlcyhldmVudClcblxuICAgIGV4dCA9IGZpbGVzWzBdWyduYW1lJ10uc3Vic3RyaW5nKGZpbGVzWzBdWyduYW1lJ10ubGFzdEluZGV4T2YoJy4nKSArIDEpLnRvTG93ZXJDYXNlKClcbiAgICBpZiAoZmlsZXNbMF0gJiYgKGV4dCA9PSBcImdpZlwiIHx8IGV4dCA9PSBcInBuZ1wiIHx8IGV4dCA9PSBcImpwZWdcIiB8fCBleHQgPT0gXCJqcGdcIikpXG4gICAgICAgIFxuICAgICAgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKVxuICAgICAgcmVhZGVyLm9ubG9hZCA9IChldmVudCk9PlxuICAgICAgICBcbiAgICAgICAgQGF2YXRhclRlbXBsYXRlLmNvbnRlbnQucXVlcnlTZWxlY3RvcignaW1nJykuc3JjID0gZXZlbnQudGFyZ2V0LnJlc3VsdFxuICAgICAgICBhdmF0YXIgPSBkb2N1bWVudC5pbXBvcnROb2RlIEBhdmF0YXJUZW1wbGF0ZS5jb250ZW50LCB0cnVlXG4gICAgICAgIHByZXYgPSBAZmlsZVNlbGVjdG9yLnByZXYoKVxuICAgICAgICBpZiBwcmV2Lmhhc0NsYXNzKCdjdXJyZW50LWF2YXRhcicpXG4gICAgICAgICAgcHJldi5yZW1vdmUoKVxuICAgICAgICBAZmlsZVNlbGVjdG9yLmJlZm9yZSBhdmF0YXJcbiAgICAgICAgQGZpbGVTZWxlY3Rvci5wcmV2KCkuZmluZCgnLmNsb3NlJykub24gJ2NsaWNrJywgQHJlbW92ZUF2YXRhclxuXG4gICAgICByZWFkZXIucmVhZEFzRGF0YVVSTCBmaWxlc1swXVxuXG5cbiAgYWZ0ZXJDaGVjazogKGV2ZW50KT0+XG4gICAgXG4gICAgaWYgQGZvcm0uZmluZCgnaW5wdXQudWktc3RhdGUtZXJyb3IsIHNlbGVjdC51aS1zdGF0ZS1lcnJvciwgdGV4dGFyZWEudWktc3RhdGUtZXJyb3InKS5sZW5ndGggPiAwXG4gICAgICByZXR1cm4gZmFsc2VcblxuICAgIGRyb3BfZG93bl9lcnIgPSBmYWxzZVxuICAgIGZvciBpbnB1dCBpbiBAZm9ybS5maW5kKCcuZHJvcGRvd24td2lkZ2V0JylcbiAgICAgIGlmICFpbnB1dC5jb250cm9sbGVyLnZhbGlkYXRlKClcbiAgICAgICAgY29uc29sZS5sb2cgJ9C+0YjQuNCx0LrQsCdcbiAgICAgICAgZHJvcF9kb3duX2VyciA9IHRydWVcblxuICAgIGlmIGRyb3BfZG93bl9lcnJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcbiAgICAgIHJldHVybiBmYWxzZVxuXG5cbiQoZG9jdW1lbnQpLnJlYWR5IC0+XG4gIG5ldyBQZXJzb25hbERhdGEoKSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==